<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Vignette Author" />

<meta name="date" content="2017-06-23" />

<title>Hall-Yarborough correlation</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Hall-Yarborough correlation</h1>
<h4 class="author"><em>Vignette Author</em></h4>
<h4 class="date"><em>2017-06-23</em></h4>



<div id="how-do-we-find-the-limits-of-accuracy-in-the-hy-correlation" class="section level2">
<h2>How do we find the limits of accuracy in the HY correlation</h2>
</div>
<div id="get-z-at-selected-ppr-and-tpr" class="section level2">
<h2>Get <code>z</code> at selected <code>Ppr</code> and <code>Tpr</code></h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># get a z value using HY</span>
<span class="kw">library</span>(zFactor)

<span class="kw">z.HallYarborough</span>(<span class="dt">pres.pr =</span> <span class="fl">1.5</span>, <span class="dt">temp.pr =</span> <span class="fl">2.0</span>)</code></pre></div>
<pre><code>[1] 0.9580002</code></pre>
<p>From the Standing-Katz chart we obtain a digitized point:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># get a z value from the SK chart at the same Ppr and Tpr</span>
<span class="kw">library</span>(zFactor)

tpr_vec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">2.0</span>)
<span class="kw">getStandingKatzMatrix</span>(<span class="dt">tpr_vector =</span> tpr_vec, 
                      <span class="dt">pprRange =</span> <span class="st">&quot;lp&quot;</span>)[<span class="dv">1</span>, <span class="st">&quot;1.5&quot;</span>]</code></pre></div>
<pre><code>  1.5 
0.956 </code></pre>
</div>
<div id="get-z-at-selected-ppr-and-tpr-1" class="section level2">
<h2>Get <code>z</code> at selected <code>Ppr</code> and <code>Tpr</code></h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zFactor)

<span class="kw">z.HallYarborough</span>(<span class="dt">pres.pr =</span> <span class="fl">1.5</span>, <span class="dt">temp.pr =</span> <span class="fl">1.1</span>)</code></pre></div>
<pre><code>[1] 0.4732393</code></pre>
<p>From the Standing-Katz chart we obtain a digitized point:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zFactor)

tpr_vec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.1</span>)
<span class="kw">getStandingKatzMatrix</span>(<span class="dt">tpr_vector =</span> tpr_vec, 
                      <span class="dt">pprRange =</span> <span class="st">&quot;lp&quot;</span>)[<span class="dv">1</span>, <span class="st">&quot;1.5&quot;</span>]</code></pre></div>
<pre><code>  1.5 
0.426 </code></pre>
<blockquote>
<p>We perceive a noticeable difference between the values of z from the HY calculation and the value read from the Standing-Katz chart.</p>
</blockquote>
</div>
<div id="get-values-of-z-for-several-ppr-and-tpr" class="section level2">
<h2>Get values of <code>z</code> for several <code>Ppr</code> and <code>Tpr</code></h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># test HY with 1st-derivative using the values from paper </span>
 
ppr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>, <span class="fl">6.5</span>) 
tpr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.3</span>, <span class="fl">1.5</span>, <span class="fl">1.7</span>, <span class="dv">2</span>) 
 
hy &lt;-<span class="st"> </span><span class="kw">sapply</span>(ppr, function(x)  
    <span class="kw">sapply</span>(tpr, function(y) <span class="kw">z.HallYarborough</span>(<span class="dt">pres.pr =</span> x, <span class="dt">temp.pr =</span> y))) 
 
<span class="kw">rownames</span>(hy) &lt;-<span class="st"> </span>tpr 
<span class="kw">colnames</span>(hy) &lt;-<span class="st"> </span>ppr 
<span class="kw">print</span>(hy) </code></pre></div>
<pre><code>          0.5       1.5       2.5       3.5       4.5       5.5       6.5
1.3 0.9176300 0.7534433 0.6399020 0.6323003 0.6881127 0.7651710 0.8493794
1.5 0.9496855 0.8581232 0.7924067 0.7687902 0.7868071 0.8316848 0.8906351
1.7 0.9682547 0.9134862 0.8756412 0.8605668 0.8694525 0.8978885 0.9396353
2   0.9838234 0.9580002 0.9426939 0.9396286 0.9490995 0.9697839 0.9994317</code></pre>
<p>With the same ppr and tpr vector, we do the same for the Standing-Katz chart:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zFactor)

sk &lt;-<span class="st"> </span><span class="kw">getStandingKatzMatrix</span>(<span class="dt">ppr_vector =</span> ppr, <span class="dt">tpr_vector =</span> tpr)
sk</code></pre></div>
<pre><code>       0.5   1.5   2.5   3.5   4.5   5.5   6.5
1.30 0.916 0.756 0.638 0.633 0.684 0.759 0.844
1.50 0.948 0.859 0.794 0.770 0.790 0.836 0.892
1.70 0.968 0.914 0.876 0.857 0.864 0.897 0.942
2.00 0.982 0.956 0.941 0.937 0.945 0.969 1.003</code></pre>
<p>Subtract and find the difference:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">err &lt;-<span class="st"> </span><span class="kw">round</span>((sk -<span class="st"> </span>hy) /<span class="st"> </span>sk *<span class="st"> </span><span class="dv">100</span>, <span class="dv">2</span>)
err</code></pre></div>
<pre><code>       0.5   1.5   2.5   3.5   4.5   5.5   6.5
1.30 -0.18  0.34 -0.30  0.11 -0.60 -0.81 -0.64
1.50 -0.18  0.10  0.20  0.16  0.40  0.52  0.15
1.70 -0.03  0.06  0.04 -0.42 -0.63 -0.10  0.25
2.00 -0.19 -0.21 -0.18 -0.28 -0.43 -0.08  0.36</code></pre>
</div>
<div id="error-by-ppr-and-by-ppr" class="section level2">
<h2>Error by Ppr and by PPr</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">colSums</span>(err))</code></pre></div>
<pre><code>  0.5   1.5   2.5   3.5   4.5   5.5   6.5 
-0.58  0.29 -0.24 -0.43 -1.26 -0.47  0.12 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">rowSums</span>(err))</code></pre></div>
<pre><code> 1.30  1.50  1.70  2.00 
-2.08  1.35 -0.83 -1.01 </code></pre>
</div>
<div id="analyze-the-error-for-smaller-values-of-tpr" class="section level2">
<h2>Analyze the error for smaller values of <code>Tpr</code></h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zFactor)

tpr2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.05</span>, <span class="fl">1.1</span>) 
ppr2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>) 


sk2 &lt;-<span class="st"> </span><span class="kw">getStandingKatzMatrix</span>(<span class="dt">ppr_vector =</span> ppr2, <span class="dt">tpr_vector =</span> tpr2, <span class="dt">pprRange =</span> <span class="st">&quot;lp&quot;</span>)
sk2</code></pre></div>
<pre><code>       0.5   1.5   2.5   3.5   4.5   5.5
1.05 0.829 0.253 0.343 0.471 0.598 0.727
1.10 0.854 0.426 0.393 0.500 0.615 0.729</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># find what common values of PPr are available in the chart</span>
<span class="kw">getStandingKatzMatrix</span>(<span class="dt">tpr_vector =</span> <span class="kw">c</span>(<span class="fl">1.05</span>))</code></pre></div>
<pre><code>       0.2   0.3   0.4   0.5  0.6   0.7     1  1.2  1.3 1.332 1.351 1.357
[1,] 0.937 0.905 0.866 0.829 0.79 0.748 0.589 0.44 0.35 0.319   0.3  0.29
     1.363  1.37 1.372 1.373 1.378 1.386   1.4 1.441   1.5   1.6   1.7
[1,] 0.285 0.279 0.274  0.27 0.267 0.264 0.262 0.257 0.253 0.251 0.252
     1.753  1.8 1.849  1.9 1.951    2   2.1   2.5     3   3.5     4   4.5
[1,] 0.255 0.26 0.265 0.27 0.275 0.28 0.291 0.343 0.407 0.471 0.534 0.598
         5   5.2   5.3   5.5  5.7     6   6.5     7   7.1   7.2   7.3  7.4
[1,] 0.663 0.688 0.701 0.727 0.75 0.786 0.846 0.904 0.916 0.928 0.939 0.95
       7.5   7.6   7.8 7.941     8
[1,] 0.962 0.973 0.995 1.011 1.018</code></pre>
<p>We do the same with the HY correlation:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate z values at lower values of Tpr</span>
<span class="kw">library</span>(zFactor)

hy2 &lt;-<span class="st"> </span><span class="kw">sapply</span>(ppr2, function(x)  
    <span class="kw">sapply</span>(tpr2, function(y) <span class="kw">z.HallYarborough</span>(<span class="dt">pres.pr =</span> x, <span class="dt">temp.pr =</span> y))) 
 
<span class="kw">rownames</span>(hy2) &lt;-<span class="st"> </span>tpr2
<span class="kw">colnames</span>(hy2) &lt;-<span class="st"> </span>ppr2
<span class="kw">print</span>(hy2)</code></pre></div>
<pre><code>           0.5       1.5       2.5       3.5       4.5       5.5
1.05 0.8324659 0.3098781 0.3844710 0.4996188 0.6150882 0.7291019
1.1  0.8565046 0.4732393 0.4138513 0.5136995 0.6220391 0.7307972</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">err2 &lt;-<span class="st"> </span><span class="kw">round</span>((sk2 -<span class="st"> </span>hy2) /<span class="st"> </span>sk2 *<span class="st"> </span><span class="dv">100</span>, <span class="dv">2</span>)
err2</code></pre></div>
<pre><code>       0.5    1.5    2.5   3.5   4.5   5.5
1.05 -0.42 -22.48 -12.09 -6.08 -2.86 -0.29
1.10 -0.29 -11.09  -5.31 -2.74 -1.14 -0.25</code></pre>
<p>We can see that using Hall-Yarborough correlation shows a very high error at values of <code>Tpr</code> lower or equal than <code>1.1</code> being <code>Tpr=1.05</code> the worst curve to extract z values from.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t_err2 &lt;-<span class="st"> </span><span class="kw">t</span>(err2)
t_err2</code></pre></div>
<pre><code>      1.05   1.10
0.5  -0.42  -0.29
1.5 -22.48 -11.09
2.5 -12.09  -5.31
3.5  -6.08  -2.74
4.5  -2.86  -1.14
5.5  -0.29  -0.25</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum_t_err2 &lt;-<span class="st"> </span><span class="kw">summary</span>(t_err2)
sum_t_err2</code></pre></div>
<pre><code>      1.05             1.10         
 Min.   :-22.48   Min.   :-11.0900  
 1st Qu.:-10.59   1st Qu.: -4.6675  
 Median : -4.47   Median : -1.9400  
 Mean   : -7.37   Mean   : -3.4700  
 3rd Qu.: -1.03   3rd Qu.: -0.5025  
 Max.   : -0.29   Max.   : -0.2500  </code></pre>
<p>We can see that the errors in <code>z</code> are considerable with a Min. :-22.48 % and Max. : -0.29 % for <code>Tpr=1.05</code>, and a Min. :-11.0900 % and Max. : -0.2500 % for <code>Tpr=1.10</code></p>
</div>
<div id="prepare-to-plot-sk-vs-hy-correlation" class="section level2">
<h2>Prepare to plot SK vs HY correlation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zFactor)

tpr2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.05</span>, <span class="fl">1.1</span>, <span class="fl">1.2</span>, <span class="fl">1.3</span>) 
ppr2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="fl">2.5</span>, <span class="fl">3.0</span>, <span class="fl">3.5</span>, <span class="fl">4.0</span>, <span class="fl">4.5</span>, <span class="fl">5.0</span>, <span class="fl">5.5</span>, <span class="fl">6.0</span>, <span class="fl">6.5</span>) 

sk_hy_2 &lt;-<span class="st"> </span><span class="kw">createTidyFromMatrix</span>(ppr2, tpr2, <span class="dt">correlation =</span> <span class="st">&quot;HY&quot;</span>)
sk_hy_2</code></pre></div>
<pre><code>    Tpr Ppr z.chart    z.calc           dif
1  1.05 0.5   0.829 0.8324659 -0.0034658585
2  1.10 0.5   0.854 0.8565046 -0.0025045862
3  1.20 0.5   0.893 0.8924176  0.0005824380
4  1.30 0.5   0.916 0.9176300 -0.0016300422
5  1.05   1   0.589 0.6023739 -0.0133739159
6  1.10   1   0.669 0.6816110 -0.0126110419
7  1.20   1   0.779 0.7761052  0.0028947795
8  1.30   1   0.835 0.8339593  0.0010406878
9  1.05 1.5   0.253 0.3098781 -0.0568780635
10 1.10 1.5   0.426 0.4732393 -0.0472392691
11 1.20 1.5   0.657 0.6573432 -0.0003432328
12 1.30 1.5   0.756 0.7534433  0.0025566692
13 1.05   2   0.280 0.3310063 -0.0510062941
14 1.10   2   0.369 0.3868827 -0.0178827360
15 1.20   2   0.554 0.5616090 -0.0076090394
16 1.30   2   0.684 0.6849205 -0.0009205474
17 1.05 2.5   0.343 0.3844710 -0.0414709978
18 1.10 2.5   0.393 0.4138513 -0.0208513280
19 1.20 2.5   0.519 0.5219634 -0.0029633874
20 1.30 2.5   0.638 0.6399020 -0.0019019748
21 1.05   3   0.407 0.4416883 -0.0346883243
22 1.10   3   0.440 0.4613206 -0.0213205702
23 1.20   3   0.534 0.5305433  0.0034566677
24 1.30   3   0.624 0.6240221 -0.0000221170
25 1.05 3.5   0.471 0.4996188 -0.0286188343
26 1.10 3.5   0.500 0.5136995 -0.0136994702
27 1.20 3.5   0.565 0.5618489  0.0031511419
28 1.30 3.5   0.633 0.6323003  0.0006997419
29 1.05   4   0.534 0.5575012 -0.0235011622
30 1.10   4   0.557 0.5676324 -0.0106323921
31 1.20   4   0.607 0.6025486  0.0044514141
32 1.30   4   0.653 0.6558686 -0.0028686167
33 1.05 4.5   0.598 0.6150882 -0.0170882109
34 1.10 4.5   0.615 0.6220391 -0.0070391411
35 1.20 4.5   0.650 0.6474310  0.0025689590
36 1.30 4.5   0.684 0.6881127 -0.0041126705
37 1.05   5   0.663 0.6722960 -0.0092959912
38 1.10   5   0.673 0.6764908 -0.0034907722
39 1.20   5   0.695 0.6943276  0.0006723892
40 1.30   5   0.719 0.7252351 -0.0062351293
41 1.05 5.5   0.727 0.7291019 -0.0021019238
42 1.10 5.5   0.729 0.7307972 -0.0017971630
43 1.20 5.5   0.741 0.7422294 -0.0012293781
44 1.30 5.5   0.759 0.7651710 -0.0061710498
45 1.05   6   0.786 0.7855086  0.0004913551
46 1.10   6   0.784 0.7848702 -0.0008701835
47 1.20   6   0.789 0.7906211 -0.0016211267
48 1.30   6   0.802 0.8067737 -0.0047736702
49 1.05 6.5   0.846 0.8415294  0.0044706343
50 1.10 6.5   0.841 0.8386698  0.0023301931
51 1.20 6.5   0.841 0.8392208  0.0017791731
52 1.30 6.5   0.844 0.8493794 -0.0053793750</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)

p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(sk_hy_2, <span class="kw">aes</span>(<span class="dt">x=</span>Ppr, <span class="dt">y=</span>z.calc, <span class="dt">group=</span>Tpr, <span class="dt">color=</span>Tpr)) +
<span class="st">    </span><span class="kw">geom_line</span>() +
<span class="st">    </span><span class="kw">geom_point</span>() +
<span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>z.calc-dif, <span class="dt">ymax=</span>z.calc+dif), <span class="dt">width=</span>.<span class="dv">4</span>,
                  <span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="fl">0.05</span>))
<span class="kw">print</span>(p)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="plot-above-is-not-plotting-right.-why" class="section level2">
<h2>Plot above is not plotting right. Why?</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Tpr should be character</span>
<span class="co"># Ppr should be numeric</span>
<span class="kw">summary</span>(sk_hy_2)</code></pre></div>
<pre><code>      Tpr            Ppr               z.chart           z.calc      
 Min.   :1.050   Length:52          Min.   :0.2530   Min.   :0.3099  
 1st Qu.:1.087   Class :character   1st Qu.:0.5490   1st Qu.:0.5606  
 Median :1.150   Mode  :character   Median :0.6600   Median :0.6648  
 Mean   :1.163                      Mean   :0.6451   Mean   :0.6539  
 3rd Qu.:1.225                      3rd Qu.:0.7802   3rd Qu.:0.7783  
 Max.   :1.300                      Max.   :0.9160   Max.   :0.9176  
      dif            
 Min.   :-0.0568781  
 1st Qu.:-0.0128018  
 Median :-0.0029160  
 Mean   :-0.0088089  
 3rd Qu.: 0.0005141  
 Max.   : 0.0044706  </code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
