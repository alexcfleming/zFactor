<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Vignette Author" />

<meta name="date" content="2017-06-23" />

<title>Hall-Yarborough correlation</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Hall-Yarborough correlation</h1>
<h4 class="author"><em>Vignette Author</em></h4>
<h4 class="date"><em>2017-06-23</em></h4>



<div id="how-do-we-find-the-limits-of-accuracy-in-the-hy-correlation" class="section level2">
<h2>How do we find the limits of accuracy in the HY correlation</h2>
</div>
<div id="get-z-at-selected-ppr-and-tpr" class="section level2">
<h2>Get <code>z</code> at selected <code>Ppr</code> and <code>Tpr</code></h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># get a z value using HY</span>
<span class="kw">library</span>(zFactor)

<span class="kw">z.HallYarborough</span>(<span class="dt">pres.pr =</span> <span class="fl">1.5</span>, <span class="dt">temp.pr =</span> <span class="fl">2.0</span>)</code></pre></div>
<pre><code>[1] 0.9580002</code></pre>
<p>From the Standing-Katz chart we obtain a digitized point:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># get a z value from the SK chart at the same Ppr and Tpr</span>
<span class="kw">library</span>(zFactor)

tpr_vec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">2.0</span>)
<span class="kw">getStandingKatzMatrix</span>(<span class="dt">tpr_vector =</span> tpr_vec, 
                      <span class="dt">pprRange =</span> <span class="st">&quot;lp&quot;</span>)[<span class="dv">1</span>, <span class="st">&quot;1.5&quot;</span>]</code></pre></div>
<pre><code>  1.5 
0.956 </code></pre>
</div>
<div id="get-z-at-selected-ppr-and-tpr-1" class="section level2">
<h2>Get <code>z</code> at selected <code>Ppr</code> and <code>Tpr</code></h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zFactor)

<span class="kw">z.HallYarborough</span>(<span class="dt">pres.pr =</span> <span class="fl">1.5</span>, <span class="dt">temp.pr =</span> <span class="fl">1.1</span>)</code></pre></div>
<pre><code>[1] 0.4732393</code></pre>
<p>From the Standing-Katz chart we obtain a digitized point:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zFactor)

tpr_vec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.1</span>)
<span class="kw">getStandingKatzMatrix</span>(<span class="dt">tpr_vector =</span> tpr_vec, 
                      <span class="dt">pprRange =</span> <span class="st">&quot;lp&quot;</span>)[<span class="dv">1</span>, <span class="st">&quot;1.5&quot;</span>]</code></pre></div>
<pre><code>  1.5 
0.426 </code></pre>
<blockquote>
<p>We perceive a noticeable difference between the values of z from the HY calculation and the value read from the Standing-Katz chart.</p>
</blockquote>
</div>
<div id="get-values-of-z-for-several-ppr-and-tpr" class="section level2">
<h2>Get values of <code>z</code> for several <code>Ppr</code> and <code>Tpr</code></h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># test HY with 1st-derivative using the values from paper </span>
 
ppr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>, <span class="fl">6.5</span>) 
tpr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.3</span>, <span class="fl">1.5</span>, <span class="fl">1.7</span>, <span class="dv">2</span>) 
 
hy &lt;-<span class="st"> </span><span class="kw">sapply</span>(ppr, function(x)  
    <span class="kw">sapply</span>(tpr, function(y) <span class="kw">z.HallYarborough</span>(<span class="dt">pres.pr =</span> x, <span class="dt">temp.pr =</span> y))) 
 
<span class="kw">rownames</span>(hy) &lt;-<span class="st"> </span>tpr 
<span class="kw">colnames</span>(hy) &lt;-<span class="st"> </span>ppr 
<span class="kw">print</span>(hy) </code></pre></div>
<pre><code>          0.5       1.5       2.5       3.5       4.5       5.5       6.5
1.3 0.9176300 0.7534433 0.6399020 0.6323003 0.6881127 0.7651710 0.8493794
1.5 0.9496855 0.8581232 0.7924067 0.7687902 0.7868071 0.8316848 0.8906351
1.7 0.9682547 0.9134862 0.8756412 0.8605668 0.8694525 0.8978885 0.9396353
2   0.9838234 0.9580002 0.9426939 0.9396286 0.9490995 0.9697839 0.9994317</code></pre>
<p>With the same ppr and tpr vector, we do the same for the Standing-Katz chart:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zFactor)

sk &lt;-<span class="st"> </span><span class="kw">getStandingKatzMatrix</span>(<span class="dt">ppr_vector =</span> ppr, <span class="dt">tpr_vector =</span> tpr)
sk</code></pre></div>
<pre><code>       0.5   1.5   2.5   3.5   4.5   5.5   6.5
1.30 0.916 0.756 0.638 0.633 0.684 0.759 0.844
1.50 0.948 0.859 0.794 0.770 0.790 0.836 0.892
1.70 0.968 0.914 0.876 0.857 0.864 0.897 0.942
2.00 0.982 0.956 0.941 0.937 0.945 0.969 1.003</code></pre>
<p>Subtract and find the difference:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">err &lt;-<span class="st"> </span><span class="kw">round</span>((sk -<span class="st"> </span>hy) /<span class="st"> </span>sk *<span class="st"> </span><span class="dv">100</span>, <span class="dv">2</span>)
err</code></pre></div>
<pre><code>       0.5   1.5   2.5   3.5   4.5   5.5   6.5
1.30 -0.18  0.34 -0.30  0.11 -0.60 -0.81 -0.64
1.50 -0.18  0.10  0.20  0.16  0.40  0.52  0.15
1.70 -0.03  0.06  0.04 -0.42 -0.63 -0.10  0.25
2.00 -0.19 -0.21 -0.18 -0.28 -0.43 -0.08  0.36</code></pre>
</div>
<div id="error-by-ppr-and-by-ppr" class="section level2">
<h2>Error by Ppr and by PPr</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">colSums</span>(err))</code></pre></div>
<pre><code>  0.5   1.5   2.5   3.5   4.5   5.5   6.5 
-0.58  0.29 -0.24 -0.43 -1.26 -0.47  0.12 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">rowSums</span>(err))</code></pre></div>
<pre><code> 1.30  1.50  1.70  2.00 
-2.08  1.35 -0.83 -1.01 </code></pre>
</div>
<div id="analyze-the-error-for-smaller-values-of-tpr" class="section level2">
<h2>Analyze the error for smaller values of <code>Tpr</code></h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zFactor)

tpr2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.05</span>, <span class="fl">1.1</span>) 
ppr2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>) 


sk2 &lt;-<span class="st"> </span><span class="kw">getStandingKatzMatrix</span>(<span class="dt">ppr_vector =</span> ppr2, <span class="dt">tpr_vector =</span> tpr2, <span class="dt">pprRange =</span> <span class="st">&quot;lp&quot;</span>)
sk2</code></pre></div>
<pre><code>       0.5   1.5   2.5   3.5   4.5   5.5
1.05 0.829 0.253 0.343 0.471 0.598 0.727
1.10 0.854 0.426 0.393 0.500 0.615 0.729</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># find what common values of PPr are available in the chart</span>
<span class="kw">getStandingKatzMatrix</span>(<span class="dt">tpr_vector =</span> <span class="kw">c</span>(<span class="fl">1.05</span>))</code></pre></div>
<pre><code>       0.2   0.3   0.4   0.5  0.6   0.7     1  1.2  1.3 1.332 1.351 1.357
[1,] 0.937 0.905 0.866 0.829 0.79 0.748 0.589 0.44 0.35 0.319   0.3  0.29
     1.363  1.37 1.372 1.373 1.378 1.386   1.4 1.441   1.5   1.6   1.7
[1,] 0.285 0.279 0.274  0.27 0.267 0.264 0.262 0.257 0.253 0.251 0.252
     1.753  1.8 1.849  1.9 1.951    2   2.1   2.5     3   3.5     4   4.5
[1,] 0.255 0.26 0.265 0.27 0.275 0.28 0.291 0.343 0.407 0.471 0.534 0.598
         5   5.2   5.3   5.5  5.7     6   6.5     7   7.1   7.2   7.3  7.4
[1,] 0.663 0.688 0.701 0.727 0.75 0.786 0.846 0.904 0.916 0.928 0.939 0.95
       7.5   7.6   7.8 7.941     8
[1,] 0.962 0.973 0.995 1.011 1.018</code></pre>
<p>We do the same with the HY correlation:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate z values at lower values of Tpr</span>
<span class="kw">library</span>(zFactor)

hy2 &lt;-<span class="st"> </span><span class="kw">sapply</span>(ppr2, function(x)  
    <span class="kw">sapply</span>(tpr2, function(y) <span class="kw">z.HallYarborough</span>(<span class="dt">pres.pr =</span> x, <span class="dt">temp.pr =</span> y))) 
 
<span class="kw">rownames</span>(hy2) &lt;-<span class="st"> </span>tpr2
<span class="kw">colnames</span>(hy2) &lt;-<span class="st"> </span>ppr2
<span class="kw">print</span>(hy2)</code></pre></div>
<pre><code>           0.5       1.5       2.5       3.5       4.5       5.5
1.05 0.8324659 0.3098781 0.3844710 0.4996188 0.6150882 0.7291019
1.1  0.8565046 0.4732393 0.4138513 0.5136995 0.6220391 0.7307972</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">err2 &lt;-<span class="st"> </span><span class="kw">round</span>((sk2 -<span class="st"> </span>hy2) /<span class="st"> </span>sk2 *<span class="st"> </span><span class="dv">100</span>, <span class="dv">2</span>)
err2</code></pre></div>
<pre><code>       0.5    1.5    2.5   3.5   4.5   5.5
1.05 -0.42 -22.48 -12.09 -6.08 -2.86 -0.29
1.10 -0.29 -11.09  -5.31 -2.74 -1.14 -0.25</code></pre>
<p>We can see that using Hall-Yarborough correlation shows a very high error at values of <code>Tpr</code> lower or equal than <code>1.1</code> being <code>Tpr=1.05</code> the worst curve to extract z values from.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t_err2 &lt;-<span class="st"> </span><span class="kw">t</span>(err2)
t_err2</code></pre></div>
<pre><code>      1.05   1.10
0.5  -0.42  -0.29
1.5 -22.48 -11.09
2.5 -12.09  -5.31
3.5  -6.08  -2.74
4.5  -2.86  -1.14
5.5  -0.29  -0.25</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum_t_err2 &lt;-<span class="st"> </span><span class="kw">summary</span>(t_err2)
sum_t_err2</code></pre></div>
<pre><code>      1.05             1.10         
 Min.   :-22.48   Min.   :-11.0900  
 1st Qu.:-10.59   1st Qu.: -4.6675  
 Median : -4.47   Median : -1.9400  
 Mean   : -7.37   Mean   : -3.4700  
 3rd Qu.: -1.03   3rd Qu.: -0.5025  
 Max.   : -0.29   Max.   : -0.2500  </code></pre>
<p>We can see that the errors in <code>z</code> are considerable with a Min. :-22.48 % and Max. : -0.29 % for <code>Tpr=1.05</code>, and a Min. :-11.0900 % and Max. : -0.2500 % for <code>Tpr=1.10</code></p>
</div>
<div id="prepare-to-plot-sk-vs-hy-correlation" class="section level2">
<h2>Prepare to plot SK vs HY correlation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(zFactor)

tpr2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.05</span>, <span class="fl">1.1</span>, <span class="fl">1.2</span>, <span class="fl">1.3</span>) 
ppr2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="fl">2.5</span>, <span class="fl">3.0</span>, <span class="fl">3.5</span>, <span class="fl">4.0</span>, <span class="fl">4.5</span>, <span class="fl">5.0</span>, <span class="fl">5.5</span>, <span class="fl">6.0</span>, <span class="fl">6.5</span>) 

sk_hy_2 &lt;-<span class="st"> </span><span class="kw">createTidyFromMatrix</span>(ppr2, tpr2)</code></pre></div>
<pre><code>Error in createTidyFromMatrix(ppr2, tpr2): argument &quot;correlation&quot; is missing, with no default</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sk_hy_2</code></pre></div>
<pre><code>Error in eval(expr, envir, enclos): object 'sk_hy_2' not found</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># library(ggplot2)</span>

p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(sk_hy_2, <span class="kw">aes</span>(<span class="dt">x=</span>Ppr, <span class="dt">y=</span>z.calc, <span class="dt">group=</span>Tpr, <span class="dt">color=</span>Tpr)) +
<span class="st">    </span><span class="kw">geom_line</span>() +
<span class="st">    </span><span class="kw">geom_point</span>() +
<span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>z.calc-dif, <span class="dt">ymax=</span>z.calc+dif), <span class="dt">width=</span>.<span class="dv">4</span>,
                  <span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="fl">0.05</span>))</code></pre></div>
<pre><code>Error in ggplot(sk_hy_2, aes(x = Ppr, y = z.calc, group = Tpr, color = Tpr)): object 'sk_hy_2' not found</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(p)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
