---
title: "Measuring the *error* in calculating $z$"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

## Practical example
To demonstrate graphically the difference between correlation and experimental data we will use the Hall-Yarborough correlation results at a $T_{pr}$=1.05 at various $P_{pr}$.

```{r}
library(zFactor)
library(tibble)
library(ggplot2)

zFactor:::z.plot.range("HY", interval = "fine")
```


## Accuracy measurement
The comparative analysis shows tables with different error measurements:

    RMSE:  Root Mean Squared Error
    MPE:   Mean Percentage error
    MAPE:  Mean Absolute Percentage Error
    MSE:   Mean Squared Error
    RSS:   Residual sum of Squares
    MAE:   Mean Absolute Error


where:

$a_t$ are the observed true values. In our case the Standing-Katz chart $z$ values;    
$f_t$ are the calculated or predicted values (the $z$ values calculated by the correlations); and    
$n$ is the number of samples


## RMSE: Root Mean Squared Error
Measure of accuracy, to compare errors of different calculation models for the same dataset.

$$RMSE =  \sqrt {\sum_{t=1}^n \frac {(a_t - f_t)^2} {n}}$$

<u>RMSE code</u>
```{r eval=FALSE}
RMSE = sqrt(mean((z.chart - z.calc)^2))
```


```{r}
sum_tpr <- as.tibble(z.stats("HY"))
hy <- ggplot(sum_tpr, aes(x = Tpr, y = RMSE, col = Tpr)) +
           geom_point()  + theme(legend.position="none") + 
    ggtitle("HY - Root Mean Squared Error")
hy
```


## MPE: Mean Percentage error


$$MPE = \frac {100%} {n} \sum_{t=1}^n \frac {a_t - f_t} {a_t}$$

<u>MPE code</u>
```{r eval=FALSE}
MPE  = sum((z.calc - z.chart) / z.chart) * 100 / n(),
```

```{r}
sum_tpr <- as.tibble(z.stats("HY"))
hy <- ggplot(sum_tpr, aes(x = Tpr, y = MPE, col = Tpr)) +
           geom_point()  + theme(legend.position="none") + 
    ggtitle("HY  - Mean Percentage error")
hy
```


## MAPE: Mean Absolute Percentage Error

$$MAPE = \frac {100} {n} \sum | \frac {a_t - f_t} {a_t}|$$

<u>MAPE code</u>
```{r eval=FALSE}
MAPE = sum(abs((z.calc - z.chart) / z.chart)) * 100 / n()
```


```{r}
sum_tpr <- as.tibble(z.stats("HY"))
hy <- ggplot(sum_tpr, aes(x = Tpr, y = MAPE, col = Tpr)) +
           geom_point()  + theme(legend.position="none") + 
    ggtitle("HY - Mean Absolute Percentage Error")
hy
```


## MSE: Mean Squared Error
$$MSE = \frac {1}{n}  \sum_{t=1}^n (a_t - f_t)^2 $$
<u>MSE code</u>
```{r eval=FALSE}
MSE  = sum((z.calc - z.chart)^2) / n()
```


```{r}
sum_tpr <- as.tibble(z.stats("HY"))
hy <- ggplot(sum_tpr, aes(x = Tpr, y = MSE, col = Tpr)) +
           geom_point()  + theme(legend.position="none") + 
    ggtitle("HY - Mean Squared Error")
hy
```


## RSS: Residual sum of Squares
$$RSS =  \sum_{t=1}^n (a_t - f_t)^2 $$
<u>RSS code</u>
```{r eval=FALSE}
RSS  = sum((z.calc - z.chart)^2)
```

```{r}
sum_tpr <- as.tibble(z.stats("HY"))
hy <- ggplot(sum_tpr, aes(x = Tpr, y = RSS, col = Tpr)) +
           geom_point()  + theme(legend.position="none") + 
    ggtitle("HY - Residual sum of Squares")
hy
```


## MAE: Mean Absolute Error

$$MAE = \frac {1} {n} \sum | {a_t - f_t} |$$
<u>MAE code</u>
```{r eval=FALSE}
MAE  = sum(abs(z.calc - z.chart)) / n()
```

```{r}
sum_tpr <- as.tibble(z.stats("HY"))
hy <- ggplot(sum_tpr, aes(x = Tpr, y = MAE, col = Tpr)) +
           geom_point()  + theme(legend.position="none") + 
    ggtitle("HY - Mean Absolute Error")
hy
```

## RMSE vs isotherm for all correlations

```{r}
sum_tpr <- as.tibble(z.stats("BB"))
bb <- ggplot(sum_tpr, aes(x = Tpr, y = RMSE, color = Tpr)) +
           geom_point() + ylim(0, 0.4) + theme(legend.position="none") +
    ggtitle("Beggs-Brill")
bb
```

```{r}
sum_tpr <- as.tibble(z.stats("HY"))
hy <- ggplot(sum_tpr, aes(x = Tpr, y = RMSE, col = Tpr)) +
           geom_point() + ylim(0, 0.4) + theme(legend.position="none") + 
    ggtitle("Hall-Yarborough")
hy
```

```{r}
sum_tpr <- as.tibble(z.stats("DAK"))
dak <- ggplot(sum_tpr, aes(x = Tpr, y = RMSE, col = Tpr)) +
           geom_point() + ylim(0, 0.4) + theme(legend.position="none") +
    ggtitle("Dranchuk-AbouKassem")
dak
```

```{r}
sum_tpr <- as.tibble(z.stats("SH"))
sh <- ggplot(sum_tpr, aes(x = Tpr, y = RMSE, col = Tpr)) +
           geom_point() + ylim(0, 0.4) + theme(legend.position="none") +
    ggtitle("Shell")
sh
```

```{r}
sum_tpr <- as.tibble(z.stats("N10"))
n10 <- ggplot(sum_tpr, aes(x = Tpr, y = RMSE, col = Tpr)) +
           geom_point() + ylim(0, 0.4) + theme(legend.position="none") +
    ggtitle("Neural-Network-10")
n10
```

```{r}
sum_tpr <- as.tibble(z.stats("PP"))
pp <- ggplot(sum_tpr, aes(x = Tpr, y = RMSE, col = Tpr)) +
           geom_point() + ylim(0, 0.4) + theme(legend.position="none") +
    ggtitle("Papp")
pp

```





